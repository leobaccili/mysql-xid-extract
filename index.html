<!DOCTYPE html>
  <head>
    <meta charset="utf-8" />
    <meta name="description" content="mysql-xid-extract - Extract XID from XA TRANSACTIONS" />
    <meta name="author" content="Léo Baccili" />
    <title>mysql-xid-extract - Extract XID from XA TRANSACTIONS (what a suffering)</title>

    <link href="https://fonts.googleapis.com/css?family=Chivo:400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700" rel="stylesheet">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  </head>

  <body class="container">
    <h1>mysql-xid-extract - Extract XID from XA TRANSACTIONS</h1>
    <p>
      Go to the mysql terminal and send this command to get the XA TRANSACTION stucked: <strong>XA RECOVER CONVERT XID;</strong>;
	  </p>
      
      

      <p>A result like this will be appear:</p>
      <code>
      +----------+--------------+--------------+------------------------------------------------------------------------------------------+ <br>
      | formatID | gtrid_length | bqual_length | data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br>
      +----------+--------------+--------------+------------------------------------------------------------------------------------------+<br>
      |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;40 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 | 0x65386234623938362D343062382D346335612D383437342D3730363163346264356563363A313236313237 |<br>
      +----------+--------------+--------------+------------------------------------------------------------------------------------------+<br>
      </code>
      &nbsp;
      <p>Fill the fields and <strong>VOILÀ!</strong></p>
      
      <div class="row">
        <div class="col-md-12">
          <div class="form-group">
            <label>formatID</label>
            <input type="text" class="form-control" id="formatID" value="">
          </div>
          <div class="form-group">
            <label>gtrid_length</label>
            <input type="text" class="form-control" id="gtrid_length" value="">
          </div>
          <div class="form-group">
            <label>bqual_length</label>
            <input type="text" class="form-control" id="bqual_length" value="">
          </div>
          <div class="form-group">
            <label>data</label>
            <input type="text" class="form-control" id="data" value="">
          </div>
          <br>
          <div class="form-group">
            <button type="submit" id="magic" class="btn btn-primary mb-3">MAKE THE MAGIC</button>
          </div>
        </div>
      </div>
      <div class="alert alert-success">
        <h2>Result:</h2>
        <p>gtrid: <span class="gtrid"></span></p>
        <p>bqual: <span class="bqual"></span></p>
        <p>formatID: <span class="formatID"></span></p>
        <h2>Command:</h2>
        <p class="alert-link">
          XA COMMIT 0x<span class="gtrid"></span>,0x<span class="bqual"></span>,<span class="formatID"></span>
        </p>
      </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-latest.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>
    <script>
      $(document).ready(function() {
        $('#magic').click(function() {
          let formatID = $('#formatID').val();
          let gtrid_length = $('#gtrid_length').val();
          let bqual_length = $('#bqual_length').val();
          let data = $('#data').val().substr(2);
          let gtrid = data.substr(0, gtrid_length * 2);
          let bqual = data.substr(gtrid_length * 2, bqual_length * 2);
          $('.gtrid').text(gtrid);
          $('.bqual').text(bqual);
          $('.formatID').text(formatID);
        })
      });
    </script>
  </body>
</html>
